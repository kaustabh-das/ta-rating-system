function e(){import.meta.url,import("_").catch(()=>1),async function*(){}().next()}import"./utils-CsyM6iPT.js";import"./services-Dtj_V1ly.js";import"./managers-BWLVgtEG.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();window.CONFIG={apiUrl:"https://script.google.com/macros/s/AKfycbz09ywNpQETLLvf178Cf50Kp2MRZBMUKo35Jc44Zvk5k0Na6ePZJ5p6hHsmtlSrzTzw/exec",MINIMUM_REVIEW_PERIOD_DAYS:90,DATE_FORMAT:"en-GB",MINIMUM_DATE:"2020-01-01"},window.MOCK_DATA={users:[{phoneNumber:"1234567890",password:"password123",userType:"mentor",name:"John Mentor"},{phoneNumber:"9876543210",password:"securepass",userType:"officer",name:"Susan Officer"}],tas:[{taId:"ta1",name:"Kaustabh Das",department:"Computer Science"},{taId:"ta2",name:"Mrinal Kalita",department:"Electronics"},{taId:"ta3",name:"Susan Kumar",department:"Civil"}]},window.RATING_CATEGORIES=[{key:"discipline",label:"Discipline"},{key:"ethics",label:"Ethics"},{key:"knowledge",label:"Knowledge"},{key:"communication",label:"Communication"},{key:"teamwork",label:"Teamwork"}];const t=new class{constructor(){this.users=[],this.taList=[],this.currentUserType="",this.currentUserPhone="",this.currentUserName="",this.selectedTAId="",this.selectedTAName="",this.selectedStartDate="",this.selectedEndDate="",this.existingReviewPeriods=[],this.currentDisplayedPeriod=null,this.currentMentorDisplayedPeriod=null,this.currentOfficerDisplayedPeriod=null,this.dataLoaded=!1}setCurrentUser(e,t,n){this.currentUserPhone=e,this.currentUserName=t,this.currentUserType=n,this.selectedTAId="",this.selectedTAName="",this.selectedStartDate="",this.selectedEndDate="",this.existingReviewPeriods=[],this.currentDisplayedPeriod=null,this.currentMentorDisplayedPeriod=null,this.currentOfficerDisplayedPeriod=null}getCurrentUser(){return{phone:this.currentUserPhone,name:this.currentUserName,type:this.currentUserType}}setSelectedTA(e,t){this.selectedTAId=e,this.selectedTAName=t,this.selectedStartDate="",this.selectedEndDate="",this.existingReviewPeriods=[],this.currentDisplayedPeriod=null,this.currentMentorDisplayedPeriod=null,this.currentOfficerDisplayedPeriod=null}getSelectedTA(){return{id:this.selectedTAId,name:this.selectedTAName}}setDateRange(e,t){this.selectedStartDate=this.formatDateForStorage(e),this.selectedEndDate=this.formatDateForStorage(t)}formatDateForStorage(e){if(!e)return"";let t;const n=String(e).trim();if(n.match(/^\d{4}-\d{2}-\d{2}$/))t=new Date(n);else if(n.includes("/")){const e=n.split("/");if(3===e.length){let n=parseInt(e[2]);n<100&&(n+=n<50?2e3:1900),t=new Date(n,e[1]-1,e[0])}}else t=new Date(n);if(t&&!isNaN(t.getTime())){const e=String(t.getDate()).padStart(2,"0"),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getFullYear()).slice(-2);return"".concat(e,"/").concat(n,"/").concat(a)}return n}getDateRange(){return{startDate:this.selectedStartDate,endDate:this.selectedEndDate}}saveToSession(){sessionStorage.setItem("isLoggedIn","true"),sessionStorage.setItem("userPhone",this.currentUserPhone),sessionStorage.setItem("userType",this.currentUserType),sessionStorage.setItem("userName",this.currentUserName)}loadFromSession(){const e="true"===sessionStorage.getItem("isLoggedIn");return e&&(this.currentUserPhone=sessionStorage.getItem("userPhone")||"",this.currentUserType=sessionStorage.getItem("userType")||"",this.currentUserName=sessionStorage.getItem("userName")||""),e}clearSession(){sessionStorage.removeItem("isLoggedIn"),sessionStorage.removeItem("userPhone"),sessionStorage.removeItem("userType"),sessionStorage.removeItem("userName")}reset(){this.selectedTAId="",this.selectedTAName="",this.selectedStartDate="",this.selectedEndDate="",this.existingReviewPeriods=[],this.currentDisplayedPeriod=null,this.currentMentorDisplayedPeriod=null,this.currentOfficerDisplayedPeriod=null}clearDisplayedPeriod(){this.currentDisplayedPeriod=null,this.currentMentorDisplayedPeriod=null,this.currentOfficerDisplayedPeriod=null}setMentorDisplayedPeriod(e){this.currentMentorDisplayedPeriod=e}setOfficerDisplayedPeriod(e){this.currentOfficerDisplayedPeriod=e}getCurrentDisplayedPeriodForSection(e){return"mentor"===e?this.currentMentorDisplayedPeriod:"officer"===e?this.currentOfficerDisplayedPeriod:null}};window.appState=t;const n=new class{constructor(){this.initializeElements()}initializeElements(){this.loginForm=document.getElementById("loginForm"),this.phoneInput=document.getElementById("phoneNumber"),this.passwordInput=document.getElementById("password"),this.phoneError=document.getElementById("phoneError"),this.passwordError=document.getElementById("passwordError"),this.loginError=document.getElementById("loginError"),this.loginContainer=document.getElementById("loginContainer"),this.taSelectionContainer=document.getElementById("taSelectionContainer"),this.ratingContainer=document.getElementById("ratingContainer"),this.confirmationContainer=document.getElementById("confirmationContainer"),this.reviewManagementContainer=document.getElementById("reviewManagementContainer"),this.dateRangeModal=document.getElementById("dateRangeModal"),this.mainHeader=document.getElementById("mainHeader"),this.globalUserName=document.getElementById("globalUserName"),this.globalUserRole=document.getElementById("globalUserRole"),this.globalLogoutBtn=document.getElementById("globalLogoutBtn"),this.navBreadcrumb=document.getElementById("navBreadcrumb"),this.userDisplayName=document.getElementById("userDisplayName"),this.userDisplayName2=document.getElementById("userDisplayName2"),this.userDisplayName3=document.getElementById("userDisplayName3"),this.userDisplayName4=document.getElementById("userDisplayName4"),this.taSelect=document.getElementById("taSelect"),this.taSelectError=document.getElementById("taSelectError"),this.proceedToRatingBtn=document.getElementById("proceedToRatingBtn"),this.selectedTANameDisplay=document.getElementById("selectedTAName"),this.ratingForm=document.getElementById("ratingForm"),this.ratingError=document.getElementById("ratingError"),this.logoutButton=document.getElementById("logoutButton"),this.logoutButton2=document.getElementById("logoutButton2"),this.logoutButton3=document.getElementById("logoutButton3"),this.globalLogoutBtn=document.getElementById("globalLogoutBtn"),this.backToSelectionBtn=document.getElementById("backToSelectionBtn"),this.rateAnotherBtn=document.getElementById("rateAnotherBtn"),this.loadingOverlay=document.getElementById("loadingOverlay"),this.startDateInput=document.getElementById("startDate"),this.endDateInput=document.getElementById("endDate"),this.dateRangeError=document.getElementById("dateRangeError"),this.addReviewBtn=document.getElementById("addReviewBtn"),this.proceedWithDatesBtn=document.getElementById("proceedWithDatesBtn"),this.existingReviewsList=document.getElementById("existingReviewsList"),this.reviewManagementTAName=document.getElementById("reviewManagementTAName"),this.reviewPeriodDisplay=document.getElementById("reviewPeriodDisplay")}hideAllContainers(){this.loginContainer.style.display="none",this.taSelectionContainer.style.display="none",this.ratingContainer.style.display="none",this.confirmationContainer.style.display="none",this.reviewManagementContainer.style.display="none",this.dateRangeModal&&(this.dateRangeModal.style.display="none")}resetErrors(){this.phoneError.style.display="none",this.passwordError.style.display="none",this.loginError.style.display="none",this.taSelectError.style.display="none",this.ratingError.style.display="none",this.dateRangeError.style.display="none"}updateUserDisplays(e){[this.userDisplayName,this.userDisplayName2,this.userDisplayName3,this.userDisplayName4].forEach(t=>{t&&(t.textContent=e)}),this.globalUserName&&(this.globalUserName.textContent=e.name||e),this.globalUserRole&&(this.globalUserRole.textContent=e.role||"User")}showHeader(){this.mainHeader&&(this.mainHeader.style.display="block")}hideHeader(){this.mainHeader&&(this.mainHeader.style.display="none")}updateBreadcrumb(e){this.navBreadcrumb&&(this.navBreadcrumb.innerHTML='<span class="breadcrumb-item active">'.concat(e,"</span>"))}showError(e,t){if(e){const n=e.querySelector(".error-text");n?n.textContent=t:e.textContent=t,e.classList.add("show"),e.style.display="flex"}}hideError(e){e&&(e.classList.remove("show"),e.style.display="none")}setBodyStyle(e="",t={}){document.body.className=e,Object.assign(document.body.style,t)}};window.domElements=n;class a{static displayExistingReviews(){const e=domElements.existingReviewsList;e.innerHTML="",0===appState.existingReviewPeriods.length?(e.innerHTML="<p>No reviews found for this TA.</p>",domElements.addReviewBtn.textContent="+ Add First Review",domElements.addReviewBtn.style.margin="20px auto",domElements.addReviewBtn.style.display="block"):(appState.existingReviewPeriods.forEach(t=>{const n=a.createReviewItem(t);e.appendChild(n)}),domElements.addReviewBtn.textContent="+ Add Review",domElements.addReviewBtn.style.margin="0",domElements.addReviewBtn.style.float="right",domElements.addReviewBtn.style.marginBottom="20px")}static createReviewItem(e){const t=document.createElement("div");return t.className="review-item",t.style.display="flex",t.style.justifyContent="space-between",t.style.alignItems="center",t.style.padding="10px",t.style.margin="10px 0",t.style.border="1px solid #ddd",t.style.borderRadius="5px",t.style.backgroundColor="#f9f9f9",t.innerHTML='\n            <div>\n                <div class="review-period" style="font-weight: bold;">'.concat(e.startDate," - ").concat(e.endDate,'</div>\n                <div class="review-info" style="color: #666; font-size: 0.9em;">').concat(e.raterType," | ").concat(DateUtils.formatDateCompact(new Date(e.timestamp)),"</div>\n            </div>\n            <button onclick=\"ReviewManager.viewReviewDetails('").concat(e.periodId||e.timestamp,'\')" class="btn-secondary compact-btn" style="padding: 5px 10px; background-color: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer;">View</button>\n        '),t}static viewReviewDetails(e){alert("Review details viewing will be implemented in the next update.")}}window.ReviewManager=a;class r{static async initializeOfficerRatingScreen(){try{UIUtils.showLoading("Loading rating data...");const e=document.getElementById("officerDashboard"),t=document.getElementById("mentorRatingsSection"),n=document.getElementById("officerRatingsSection");e&&(e.style.display="block"),domElements.ratingForm.style.display="none",domElements.reviewPeriodDisplay.style.display="none";const[a,i]=await Promise.allSettled([r.setupMentorRatingsSection(),r.setupOfficerRatingsSection()]);t&&(t.style.display="block"),n&&(n.style.display="block"),UIUtils.hideLoading(),a.status,i.status}catch(e){UIUtils.hideLoading(),UIUtils.showError(document.body,"Failed to load rating data")}}static async setupMentorRatingsSection(){try{const e=await r.fetchReviewPeriods("mentor"),t=document.getElementById("mentorRatingControls");if(t){t.innerHTML="";const n=r.createViewOnlyControls(e,"mentor","mentorRatingDisplay");t.appendChild(n)}const n=document.getElementById("mentorRatingDisplay");e.length>0&&n?(appState.setMentorDisplayedPeriod(e[0]),await r.displayRatingForSection(e[0],"mentor","mentorRatingDisplay",!1)):n&&(n.innerHTML='<p style="color: #666; font-style: italic;">No mentor ratings found for this TA</p>')}catch(e){}}static async setupOfficerRatingsSection(){try{const e=await r.fetchReviewPeriods("officer"),t=document.getElementById("officerRatingControls");if(t){t.innerHTML="";const n=r.createSectionControls(e,"officer","officerRatingDisplay");t.appendChild(n)}const n=document.getElementById("officerRatingDisplay");e.length>0&&n?(appState.setOfficerDisplayedPeriod(e[0]),await r.displayRatingForSection(e[0],"officer","officerRatingDisplay",!1)):n&&(n.innerHTML='<p style="color: #666; font-style: italic;">No officer ratings found for this TA</p>')}catch(e){}}static async fetchReviewPeriods(e){try{const t=await fetch("".concat(CONFIG.apiUrl,"?action=getReviewPeriods&taId=").concat(appState.selectedTAId,"&raterType=").concat(e));if(!t.ok)throw new Error("Failed to fetch review periods");const n=await t.json();return(n.periods||[]).map(e=>({...e,startDate:DateUtils.formatDateStringCompact(e.startDate),endDate:DateUtils.formatDateStringCompact(e.endDate)}))}catch(t){return[]}}static createSectionControls(e,t,n){const a=document.createElement("div");if(a.className="rating-controls",a.style.display="flex",a.style.alignItems="center",a.style.gap="10px",e.length>0){const i=appState.getCurrentDisplayedPeriodForSection(t),o=e.filter(e=>{if(!i)return!0;return!(e.startDate===i.startDate&&e.endDate===i.endDate)}),s=o.map(e=>({text:"".concat(e.startDate," - ").concat(e.endDate),value:e}));let l;l=i?"".concat(i.startDate," - ").concat(i.endDate):e.length>0?"".concat(e[0].startDate," - ").concat(e[0].endDate):"No rating periods available",s.length>0&&(l+=" ▼");const d=e.length<=1||0===o.length,c=UIUtils.createDropdown(s,e=>r.displayRatingForSection(e.value,t,n),l,d);c.container.style.maxWidth="250px",c.container.style.flexShrink="1",a.appendChild(c.container)}const i=document.createElement("button");return i.type="button",i.className="compact-btn",i.textContent="+ Rating",i.style.whiteSpace="nowrap",i.addEventListener("click",()=>{ScreenManager.showDateRangeModal()}),a.appendChild(i),a}static createViewOnlyControls(e,t,n){const a=document.createElement("div");if(a.className="rating-controls",a.style.display="flex",a.style.alignItems="center",a.style.gap="10px",e.length>0){const i=appState.getCurrentDisplayedPeriodForSection(t),o=e.filter(e=>{if(!i)return!0;return!(e.startDate===i.startDate&&e.endDate===i.endDate)}),s=o.map(e=>({text:"".concat(e.startDate," - ").concat(e.endDate),value:e}));let l;l=i?"".concat(i.startDate," - ").concat(i.endDate):e.length>0?"".concat(e[0].startDate," - ").concat(e[0].endDate):"No rating periods available",s.length>0&&(l+=" ▼");const d=e.length<=1||0===o.length,c=UIUtils.createDropdown(s,e=>r.displayRatingForSection(e.value,t,n),l,d);c.container.style.maxWidth="250px",c.container.style.flexShrink="1",a.appendChild(c.container)}else{const e=document.createElement("span");e.textContent="No mentor ratings available",e.style.color="#666",e.style.fontStyle="italic",a.appendChild(e)}return a}static async displayRatingForSection(e,t,n,a=!0){try{const i=document.getElementById(n);if(!i)return;a&&UIUtils.showLoading("Loading rating data..."),"mentor"===t?appState.setMentorDisplayedPeriod(e):"officer"===t&&appState.setOfficerDisplayedPeriod(e),r.refreshSectionDropdown(t);const o=await fetch("".concat(CONFIG.apiUrl,"?action=getTARatings&taId=").concat(appState.selectedTAId));if(!o.ok)throw new Error("Failed to fetch ratings");const s=await o.json(),l=s.ratings.map(e=>({...e,startDate:DateUtils.formatDateStringCompact(e.startDate),endDate:DateUtils.formatDateStringCompact(e.endDate)})).find(n=>n.raterType===t&&n.startDate===e.startDate&&n.endDate===e.endDate);i.innerHTML=l?r.createRatingDisplayHTML(l):'\n                    <div style="padding: 15px; text-align: center; color: #666; font-style: italic;">\n                        No rating found for period: '.concat(e.startDate," - ").concat(e.endDate,"\n                    </div>\n                "),a&&UIUtils.hideLoading()}catch(i){a&&UIUtils.hideLoading();const t=document.getElementById(n);t&&(t.innerHTML='\n                    <div style="padding: 15px; text-align: center; color: #dc3545;">\n                        Error loading rating data for period: '.concat(e.startDate," - ").concat(e.endDate,"\n                    </div>\n                "))}}static refreshSectionDropdown(e){const t="mentor"===e?"mentorRatingControls":"officerRatingControls",n="mentor"===e?"mentorRatingDisplay":"officerRatingDisplay",a=document.getElementById(t);if(!a)return;const i=a.querySelector(".dropdown-container");i&&r.fetchReviewPeriods(e).then(t=>{const a=appState.getCurrentDisplayedPeriodForSection(e),o=t.filter(e=>{if(!a)return!0;return!(e.startDate===a.startDate&&e.endDate===a.endDate)}),s=o.map(e=>({text:"".concat(e.startDate," - ").concat(e.endDate),value:e}));let l;l=a?"".concat(a.startDate," - ").concat(a.endDate):s.length>0?"Select a rating period":"No rating periods available",s.length>0&&(l+=" ▼");const d=t.length<=1||0===o.length,c=UIUtils.createDropdown(s,t=>r.displayRatingForSection(t.value,e,n),l,d);c.container.style.maxWidth="250px",c.container.style.flexShrink="1",i.parentNode.replaceChild(c.container,i)})}static createRatingDisplayHTML(e){const t=DateUtils.formatDateCompact(new Date(e.timestamp)),n={name:e.raterName,type:e.raterType,date:t},a=UIUtils.createModernRatingDisplay(e,n,RATING_CATEGORIES,e.comments);return a.querySelector(".rating-info-header"),a.outerHTML}static resetSections(){const e=document.getElementById("officerDashboard"),t=document.getElementById("mentorRatingsSection"),n=document.getElementById("officerRatingsSection");e&&e.style.setProperty("display","none","important"),t&&t.style.setProperty("display","none","important"),n&&n.style.setProperty("display","none","important");const a=document.getElementById("mentorRatingControls"),r=document.getElementById("mentorRatingDisplay"),i=document.getElementById("officerRatingControls"),o=document.getElementById("officerRatingDisplay");a&&(a.innerHTML=""),r&&(r.innerHTML=""),i&&(i.innerHTML=""),o&&(o.innerHTML=""),appState.currentMentorDisplayedPeriod=null,appState.currentOfficerDisplayedPeriod=null}}window.OfficerRatingManager=r;window.EventHandlers=class e{static initialize(){e.setupLoginHandlers(),e.setupTASelectionHandlers(),e.setupRatingHandlers(),e.setupNavigationHandlers(),e.setupDateRangeHandlers(),e.setupUserDropdowns()}static setupLoginHandlers(){domElements.loginForm.addEventListener("submit",async function(e){e.preventDefault(),domElements.resetErrors();const t=domElements.phoneInput.value.trim(),n=domElements.passwordInput.value.trim(),a=[{value:t,errorElement:domElements.phoneError,message:"Phone number is required"},{value:n,errorElement:domElements.passwordError,message:"Password is required"}];if(!UIUtils.validateRequiredFields(a))return;const r=await AuthManager.handleLogin(t,n);r.success?ScreenManager.showTASelection():UIUtils.showError(domElements.loginError,r.message)})}static setupTASelectionHandlers(){domElements.proceedToRatingBtn.addEventListener("click",async function(){TAManager.handleTASelection()&&await ScreenManager.showRatingScreenWithPreviousData()})}static setupRatingHandlers(){domElements.ratingForm.addEventListener("submit",async function(e){e.preventDefault(),UIUtils.hideError(domElements.ratingError);const t=new FormData(domElements.ratingForm);await RatingManager.handleRatingSubmission(t)})}static setupNavigationHandlers(){[domElements.logoutButton,domElements.logoutButton2,domElements.logoutButton3,domElements.globalLogoutBtn].forEach(e=>{e&&e.addEventListener("click",AuthManager.logout)}),domElements.backToSelectionBtn&&domElements.backToSelectionBtn.addEventListener("click",function(){UIUtils.hideError(domElements.ratingError),RatingManager.clearValidationErrors(),ScreenManager.showTASelection(),UIUtils.resetForm(domElements.ratingForm)}),domElements.rateAnotherBtn&&domElements.rateAnotherBtn.addEventListener("click",function(){RatingManager.clearValidationErrors(),UIUtils.resetForm(domElements.ratingForm),ScreenManager.showTASelection()})}static setupDateRangeHandlers(){domElements.addReviewBtn&&domElements.addReviewBtn.addEventListener("click",ScreenManager.showDateRangeModal),domElements.proceedWithDatesBtn&&domElements.proceedWithDatesBtn.addEventListener("click",function(){DateUtils.validateDateRange()&&(appState.setDateRange(domElements.startDateInput.value,domElements.endDateInput.value),ScreenManager.closeDateRangeModal(),ScreenManager.showRatingScreenWithDateRange())}),DateUtils.setupDateInputHandlers()}static setupUserDropdowns(){document.querySelectorAll(".user-dropdown-trigger").forEach(e=>{const t=e.closest(".user-dropdown");t.querySelector(".user-dropdown-menu"),e.addEventListener("click",function(e){e.stopPropagation(),document.querySelectorAll(".user-dropdown.open").forEach(e=>{e!==t&&e.classList.remove("open")}),t.classList.toggle("open")})}),document.addEventListener("click",function(){document.querySelectorAll(".user-dropdown.open").forEach(e=>{e.classList.remove("open")})}),document.querySelectorAll(".user-dropdown-menu").forEach(e=>{e.addEventListener("click",function(e){e.stopPropagation()})})}static updateUserInfo(e,t){document.querySelectorAll(".user-name").forEach(t=>{t.id.startsWith("userName")&&(t.textContent=e)}),document.querySelectorAll(".user-role").forEach(e=>{e.id.startsWith("userRole")&&(e.textContent=t)})}};class i{static async initialize(){EventHandlers.initialize(),await AuthManager.checkExistingSession()}}window.closeDateRangeModal=function(){ScreenManager.closeDateRangeModal()},window.showTASelection=function(){ScreenManager.showTASelection()},window.logout=function(){AuthManager.logout()},window.App=i,document.addEventListener("DOMContentLoaded",()=>{i.initialize()});export{e as __vite_legacy_guard};
//# sourceMappingURL=main-DNxVMH3q.js.map
